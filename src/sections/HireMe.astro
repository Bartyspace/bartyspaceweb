<section
  id="kontakt"
  class="bg-indigo-950 pb-20">
  <div class="container mx-auto text-center text-white">
    <h2 class="pb-24 text-3xl font-bold">Kontakt</h2>
    <p class="container md:w-[500px] pb-12 text-lg">
      Zajímá vás moje práce? Neváhejte mě kontaktovat! Ať už potřebujete pomoci s
      projektem nebo máte jakékoli dotazy týkající se toho, na čem pracuji, neváhejte se
      na mě obrátit.
    </p>
    <div class="flex justify-center">
      <div class="w-full sm:w-8/12 md:w-6/12 lg:w-4/12">
        <form
          action="https://formspree.io/f/mgegnngg"
          method="POST"
          class="space-y-6"
          id="contact-form">
          <div>
            <label
              for="name"
              class="mb-3 block font-bold text-white">
              Jméno:
            </label>
            <input
              type="text"
              id="name"
              name="name"
              autocomplete="on"
              placeholder="Zadej jméno"
              class="focus:shadow-outline w-full rounded-lg border border-gray-400 px-4 py-3 text-gray-700 shadow-inner focus:border-gray-500 focus:outline-none"
              required
              aria-label="Name"
            />
          </div>
          <div>
            <label
              for="email"
              class="mb-3 block font-bold text-white">
              Email:
            </label>
            <input
              type="email"
              id="email"
              name="email"
              autocomplete="on"
              placeholder="Zadej email"
              class="focus:shadow-outline w-full rounded-lg border border-gray-400 px-4 py-3 text-gray-700 shadow-inner focus:border-gray-500 focus:outline-none"
              required
              aria-label="Email"
            />
          </div>
          <div>
            <label
              for="message"
              class="mb-3 block font-bold text-white">
              Zpráva:
            </label>
            <textarea
              name="message"
              id="message"
              cols="30"
              rows="6"
              autocomplete="off"
              placeholder="Zpráva"
              aria-label="Message"
              class="focus:shadow-outline h-24 max-h-40 min-h-12 w-full rounded-lg border border-gray-400 px-4 py-3 text-gray-700 shadow-inner focus:border-gray-500 focus:outline-none"
              required></textarea>
          </div>
          <div class="flex items-center justify-center pt-6">
            <button
              type="submit"
              id="submit-btn"
              class="relative flex transform-gpu overflow-hidden rounded-full border-2 px-6 pr-12 py-2 font-bold text-white transition-all duration-300 hover:animate-jump group">
              <span class="relative z-10 transition-colors duration-300 group-[.success]:text-green-600 group-[.error]:text-red-600" id="btn-text">Poslat!</span>
              
              <!-- Bílé pozadí pro success stav -->
              <span class="absolute inset-0 bg-white transition-all duration-300 scale-0 group-[.success]:scale-100 rounded-full"></span>
              
              <!-- Červené pozadí pro error stav -->
              <span class="absolute inset-0 bg-red-100 transition-all duration-300 scale-0 group-[.error]:scale-100 rounded-full"></span>
              
              <!-- Fajfka pro success -->
              <span class="absolute top-1/2 transform -translate-y-1/2 opacity-0 group-[.success]:opacity-100 transition-all duration-500 delay-200 ml-3" style="left: calc(100% - 24px);">
                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                </svg>
              </span>
              
              <!-- Křížek pro error -->
              <span class="absolute top-1/2 transform -translate-y-1/2 opacity-0 group-[.error]:opacity-100 transition-all duration-500 delay-200 ml-3" style="left: calc(100% - 24px);">
                <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </span>
              
              <!-- Loading spinner -->
              <span class="absolute top-1/2 transform -translate-y-1/2 opacity-0 group-[.loading]:opacity-100 transition-all duration-300 ml-3" style="left: calc(100% - 24px);">
                <svg class="w-5 h-5 text-white animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </span>
              
              <span class="absolute inset-0 overflow-hidden rounded-full">
                <span class="animate-shine to-transpatent absolute left-0 top-0 h-8 w-full bg-gradient-to-t from-transparent via-white opacity-0">
                </span>
              </span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
const contactForm = document.getElementById('contact-form') as HTMLFormElement;
if (contactForm) {
  contactForm.addEventListener('submit', async function(e) {
    e.preventDefault(); // Zabrání přesměrování
    
    const button = document.getElementById('submit-btn') as HTMLButtonElement;
    const buttonText = document.getElementById('btn-text');
    const formData = new FormData(contactForm);
    
    // Nastaví loading stav
    if (button) {
      button.disabled = true;
      button.classList.add('loading');
    }
    if (buttonText) {
      buttonText.textContent = 'Odesílám...';
    }
    
    try {
      // Odešle form přes AJAX
      const response = await fetch(contactForm.action, {
        method: 'POST',
        body: formData,
        headers: {
          'Accept': 'application/json'
        }
      });
      
      if (response.ok) {
        // Úspěšné odeslání - animace úspěchu
        if (button) {
          button.classList.remove('loading');
          button.classList.add('success');
        }
        if (buttonText) {
          buttonText.textContent = 'Odesláno!';
        }
        
        // Vymaže form
        contactForm.reset();
        
        // Po 3 sekundách vrátí původní stav
        setTimeout(() => {
          if (button) {
            button.disabled = false;
            button.classList.remove('success');
          }
          if (buttonText) {
            buttonText.textContent = 'Poslat!';
          }
        }, 3000);
        
      } else {
        throw new Error('Chyba při odesílání');
      }
      
    } catch (error) {
      // Chyba při odesílání
      if (button) {
        button.classList.remove('loading');
        button.classList.add('error');
      }
      if (buttonText) {
        buttonText.textContent = 'Chyba!';
      }
      
      // Po 3 sekundách vrátí původní stav
      setTimeout(() => {
        if (button) {
          button.disabled = false;
          button.classList.remove('error');
        }
        if (buttonText) {
          buttonText.textContent = 'Poslat!';
        }
      }, 3000);
    }
  });
}
</script>
