---

import Carousel from '../elements/Carousel.astro'
---

<section id="projects" class="w-screen bg-indigo-950 lg:max-h-screen">
	<h2 class="container w-52 pt-6 text-center text-3xl font-semibold text-white">My projects</h2>
	<Carousel />
	<script is:inline data-astro-rerun>
		const carouselList = document.querySelector('.carousel__wrapper')
		const carouselItems = document.querySelectorAll('.carousel__item')
		const elems = Array.from(carouselItems)

		carouselList.addEventListener('click', function (event) {
			const newActive = event.target.closest('.carousel__item')
			if (!newActive || newActive.classList.contains('carousel__item_active')) {
				return
			}
			update(newActive)
		})

		function update(newActive) {
			const newActivePos = Number(newActive.dataset.pos)
			const current = elems.find((elem) => Number(elem.dataset.pos) === 0)
			const prev = elems.find((elem) => Number(elem.dataset.pos) === -1)
			const next = elems.find((elem) => Number(elem.dataset.pos) === 1)
			const first = elems.find((elem) => Number(elem.dataset.pos) === -2)
			const last = elems.find((elem) => Number(elem.dataset.pos) === 2)

			current.classList.remove('carousel__item_active')
			;[current, prev, next, first, last].forEach((item) => {
				const itemPos = Number(item.dataset.pos)
				item.dataset.pos = getPos(itemPos, newActivePos)
			})
			newActive.classList.add('carousel__item_active')
		}

		function getPos(current, active) {
			const diff = current - active
			if (Math.abs(current - active) > 2) {
				return -current
			}
			return diff
		}
	</script>
</section>
<div class="flex h-32 w-screen items-center bg-indigo-950">
	<hr class="h-[2px] w-2/3 translate-x-1/4 border-none bg-gradient-to-r from-transparent via-gray-500 to-transparent" />
</div>

